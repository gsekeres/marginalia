Metadata-Version: 2.4
Name: marginalia
Version: 0.1.0
Summary: Agent-based academic literature management system
Author-email: Gabriel Sekeres <gs754@cornell.edu>
License: MIT
License-File: LICENSE
Keywords: academic,agents,literature,obsidian,papers
Requires-Python: >=3.10
Requires-Dist: anthropic>=0.40.0
Requires-Dist: authlib>=1.3.0
Requires-Dist: bibtexparser>=1.4.0
Requires-Dist: fastapi>=0.115.0
Requires-Dist: httpx>=0.27.0
Requires-Dist: itsdangerous>=2.1.0
Requires-Dist: pdfplumber>=0.11.0
Requires-Dist: pydantic>=2.0.0
Requires-Dist: pymupdf>=1.24.0
Requires-Dist: python-dotenv>=1.0.0
Requires-Dist: python-jose[cryptography]>=3.3.0
Requires-Dist: python-multipart>=0.0.9
Requires-Dist: rich>=13.0.0
Requires-Dist: uvicorn>=0.32.0
Provides-Extra: dev
Requires-Dist: pytest>=8.0.0; extra == 'dev'
Requires-Dist: ruff>=0.8.0; extra == 'dev'
Description-Content-Type: text/markdown

# Marginalia

An agent-based academic literature management platform that works with your Claude Code subscription.

## What It Does

Marginalia uses AI agents to automate the tedious parts of building a research library:

1. **Find PDFs** - Searches Unpaywall, Semantic Scholar, NBER, and other open-access sources
2. **Summarize Papers** - Extracts text and generates structured summaries using Claude
3. **Build Citation Graphs** - Links papers together through their citations
4. **Create an Obsidian Vault** - All summaries are Obsidian-compatible markdown with wikilinks

**Key Feature**: Uses your existing Claude Pro/Max subscription via Claude Code CLI - no separate API credits needed.

## Quick Start (Local Development)

### 1. Install Dependencies

```bash
cd Marginalia
pip install -e .
```

### 2. Set Up Claude Code CLI

Summarization requires Claude Code CLI with your subscription:

```bash
# Install Claude Code CLI (requires Node.js 18+)
npm install -g @anthropic-ai/claude-code

# Authenticate (opens browser)
claude setup-token

# Add token to .env
echo 'CLAUDE_CODE_OAUTH_TOKEN=<your-token>' >> .env
```

**Important**: Do NOT set `ANTHROPIC_API_KEY` in `.env` - the CLI will prefer it over OAuth and fail without API credits.

### 3. Run Locally

```bash
python -m agents.api
# Open http://localhost:8000
```

## Usage

1. Import your BibTeX bibliography
2. Mark papers you want to read
3. Click "Find PDFs" - Marginalia searches open-access sources
4. Papers that can't be found go to a manual queue with search links
5. Click "Summarize" to generate structured summaries
6. Open the vault folder in Obsidian for linked notes

## CLI Commands

```bash
python -m agents.cli status      # Show vault statistics
python -m agents.cli import X.bib # Import papers from BibTeX
python -m agents.cli want --all   # Mark papers for download
python -m agents.cli find         # Find and download PDFs
python -m agents.cli summarize    # Generate summaries
python -m agents.cli manual       # Show manual download queue
```

## Deployment

See [DEPLOY.md](DEPLOY.md) for deployment instructions.

**Current Architecture**:
- Frontend: Static HTML hosted on your website
- Backend: FastAPI on Render (or any Python host)
- Storage: Persistent disk for vault data

## How PDF Finding Works

The PDF Finder agent searches these sources in order:
1. **Unpaywall** - Open-access versions via DOI
2. **Semantic Scholar** - Academic search with open-access PDFs
3. **NBER** - National Bureau of Economic Research working papers
4. **Manual Queue** - If not found, generates search links

Expected success rate: ~70-85% for economics papers.

## How Summarization Works

1. Extracts text from PDF using `pdfplumber`
2. Sends to Claude Code CLI with JSON output format
3. Parses response into structured markdown:
   - Overview paragraph
   - Key contributions
   - Methodology
   - Main results
   - Related work with wikilinks

## Configuration

| Variable | Description | Required |
|----------|-------------|----------|
| `CLAUDE_CODE_OAUTH_TOKEN` | OAuth token from `claude setup-token` | Yes |
| `UNPAYWALL_EMAIL` | Email for better Unpaywall rate limits | No |
| `SEMANTIC_SCHOLAR_API_KEY` | For higher rate limits | No |
| `VAULT_PATH` | Path to vault directory (default: `./vault`) | No |

## License

MIT License

## Contributing

Contributions welcome! Please open an issue or PR on GitHub.
